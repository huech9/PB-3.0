<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frequently Asked Questions - PAM Practice Bureau</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        pam: {
                            orange: '#F7941D',
                            black: '#231F20',
                            gray: '#F5F5F5' // Keeping separate as custom gray if needed
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .active-category {
                @apply bg-pam-black text-white border-pam-black;
            }
            .inactive-category {
                @apply bg-white text-gray-600 border-gray-200 hover:border-pam-orange hover:text-pam-orange;
            }
            .tab-active {
                @apply text-pam-orange border-b-2 border-pam-orange;
            }
            .tab-inactive {
                @apply text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300;
            }
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-900 font-sans min-h-screen flex flex-col items-center">

    <!-- Main Container -->
    <main class="w-full max-w-5xl px-6 py-10 md:py-16 space-y-10 bg-white shadow-xl min-h-screen">

        <!-- Header -->
        <header class="border-b border-gray-100 pb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <h1 class="text-4xl font-bold tracking-tight text-gray-900">
                    <a href="index.html" class="hover:text-pam-orange transition-colors">PAM Practice Bureau</a>
                </h1>
                <p class="text-base text-gray-500 mt-2 font-light">Your resource for architectural practice enquiries &
                    guidelines.</p>
            </div>
            <a href="index.html"
                class="text-sm font-medium text-gray-400 hover:text-pam-orange transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                </svg>
                Back to Home
            </a>
        </header>

        <!-- Tabs -->
        <div class="flex border-b border-gray-200">
            <button id="tabTop10"
                class="tab-active flex-1 py-4 text-center font-medium text-lg transition-colors duration-200 focus:outline-none">
                Top 10 FAQs
            </button>
            <button id="tabArchive"
                class="tab-inactive flex-1 py-4 text-center font-medium text-lg transition-colors duration-200 focus:outline-none">
                Past Q&A Archive
            </button>
        </div>

        <!-- Search & Filter Controls -->
        <section class="space-y-6">
            <!-- Search Bar -->
            <div class="relative w-full">
                <input type="text" id="searchInput" placeholder="Search questions, keywords, or categories..."
                    class="w-full py-4 pl-12 pr-5 bg-gray-50 border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:border-pam-orange focus:ring-1 focus:ring-pam-orange transition-all rounded-md text-base shadow-sm">
                <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                    </svg>
                </div>
            </div>

            <!-- Categories -->
            <div class="flex flex-wrap gap-3" id="categoryFilters">
                <button
                    class="filter-btn active-category px-5 py-2 text-xs font-semibold uppercase tracking-wider border rounded-full transition-all duration-200 transform hover:scale-105"
                    data-category="all">
                    All
                </button>
                <!-- Dynamic categories will be counted and perhaps added here or static ones kept?
                     Let's keep static categories related to the new data if possible, or just dynamic. 
                     For now, let's stick to the common ones we saw: Architect's Practice, Building Control, Contract Admin. -->
                <button
                    class="filter-btn inactive-category px-5 py-2 text-xs font-semibold uppercase tracking-wider border rounded-full transition-all duration-200 transform hover:scale-105"
                    data-category="Architect's Practice">
                    Architect's Practice
                </button>
                <button
                    class="filter-btn inactive-category px-5 py-2 text-xs font-semibold uppercase tracking-wider border rounded-full transition-all duration-200 transform hover:scale-105"
                    data-category="Building Control">
                    Building Control
                </button>
                <button
                    class="filter-btn inactive-category px-5 py-2 text-xs font-semibold uppercase tracking-wider border rounded-full transition-all duration-200 transform hover:scale-105"
                    data-category="Contract Administration">
                    Contract Administration
                </button>
            </div>
        </section>

        <!-- Search Results Count -->
        <div class="flex justify-between items-end">
            <h2 id="sectionTitle" class="text-2xl font-semibold text-gray-800">Top 10 Frequently Asked Questions</h2>
            <div id="resultsCount" class="text-sm text-gray-400 font-medium">
                Showing <span id="countValue">0</span> result(s)
            </div>
        </div>

        <!-- Q&A Content List -->
        <section id="faqList" class="space-y-10">
            <!-- Content will be injected by JS -->
        </section>

        <!-- No Results Message -->
        <div id="noResults" class="hidden flex flex-col items-center justify-center py-20 text-center">
            <div class="bg-gray-100 p-4 rounded-full mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-8 h-8 text-gray-400">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                </svg>
            </div>
            <p class="text-lg text-gray-600 font-medium">No results found</p>
            <p class="text-gray-400 text-sm mt-1">Try adjusting your search or filter.</p>
            <button id="clearSearch"
                class="mt-6 px-6 py-2 bg-pam-orange text-white text-sm font-medium rounded-md hover:bg-orange-600 transition-colors shadow-sm">
                Clear Search
            </button>
        </div>

        <!-- Footer -->
        <footer class="text-center pt-16 pb-8 space-y-3 border-t border-gray-100 w-full mt-10">
            <p class="text-xs text-gray-400 max-w-2xl mx-auto leading-relaxed">
                The Practice Bureau is not a statutory authority. Certain matters fall under LAM or relevant
                authorities. The information provided is for general guidance only.
            </p>
            <p class="text-xs text-gray-300">Â© 2026 PAM Practice Bureau</p>
        </footer>

    </main>

    <!-- Load Data -->
    <script src="qa_data.js"></script>

    <!-- App Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Check if qaData is loaded
            if (typeof qaData === 'undefined') {
                console.error("qa_data.js not loaded properly.");
                document.getElementById('faqList').innerHTML = '<p class="text-red-500">Error loading data. Please run via a local server.</p>';
                return;
            }

            // State
            let currentTab = 'top10'; // 'top10' or 'archive'
            let currentCategory = 'all';
            let currentSearchTerm = '';

            // DOM Elements
            const tabTop10 = document.getElementById('tabTop10');
            const tabArchive = document.getElementById('tabArchive');
            const sectionTitle = document.getElementById('sectionTitle');
            const faqList = document.getElementById('faqList');
            const searchInput = document.getElementById('searchInput');
            const categoryBtns = document.querySelectorAll('.filter-btn');
            const noResults = document.getElementById('noResults');
            const clearSearchBtn = document.getElementById('clearSearch');
            const resultsCount = document.getElementById('resultsCount');
            const countValue = document.getElementById('countValue');

            // --- Rendering Functions ---

            function renderItem(item, index) {
                // Highlight keywords in logic if needed, but for now just plain render
                // Format Description: Date | Category

                // Truncate query if too long (optional, but requested "Full text", so keeping full)
                const queryText = item.query.replace(/\n/g, '<br>');
                const replyText = item.reply ? item.reply.replace(/\n/g, '<br>') : "No reply available.";

                return `
                <div class="group bg-white rounded-lg transition-all duration-300 hover:shadow-sm border border-transparent hover:border-gray-100">
                    <div class="flex items-start gap-5">
                        <span class="text-3xl font-light text-gray-200 group-hover:text-pam-orange transition-colors select-none font-mono -mt-1">
                            ${(index + 1).toString().padStart(2, '0')}
                        </span>
                        <article class="flex-1 space-y-3">
                            <!-- Meta Tags -->
                            <div class="flex flex-wrap items-center gap-3">
                                <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest border border-gray-200 px-2.5 py-1 rounded-full bg-gray-50">
                                    ${item.category}
                                </span>
                                <span class="text-xs text-gray-400 font-medium flex items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3">
                                      <path fill-rule="evenodd" d="M5.75 2a.75.75 0 0 1 .75.75V4h7V2.75a.75.75 0 0 1 1.5 0V4h.25A2.75 2.75 0 0 1 18 6.75v8.5A2.75 2.75 0 0 1 15.25 18H4.75A2.75 2.75 0 0 1 2 15.25v-8.5A2.75 2.75 0 0 1 4.75 4H5V2.75A.75.75 0 0 1 5.75 2Zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75Z" clip-rule="evenodd" />
                                    </svg>
                                    ${item.date}
                                </span>
                            </div>

                            <!-- Query -->
                            <h3 class="text-lg font-medium text-gray-900 leading-snug cursor-pointer group-hover:text-pam-orange transition-colors">
                                ${item.shortTitle}
                            </h3>
                            
                            <!-- Full Query Content (Initially could be hidden or shown. Let's show clearly) -->
                            <div class="bg-gray-50/50 p-5 rounded-lg border-l-4 border-gray-200 group-hover:border-pam-orange transition-colors">
                                <p class="text-sm text-gray-600 italic leading-relaxed">
                                    "${item.query}"
                                </p>
                            </div>

                            <!-- Reply -->
                            <div class="pt-2 text-sm text-gray-700 leading-relaxed md:pl-6 relative">
                                <div class="absolute left-0 top-3 bottom-0 w-px bg-gray-100"></div>
                                <h4 class="font-bold text-gray-900 mb-2 flex items-center gap-2">
                                    <span class="w-1.5 h-1.5 rounded-full bg-pam-orange"></span>
                                    Response from Team:
                                </h4>
                                <div class="prose prose-sm max-w-none text-gray-600">
                                    <p>${replyText}</p>
                                </div>
                            </div>
                        </article>
                    </div>
                    <hr class="border-gray-100 mt-10" />
                </div>
                `;
            }

            function filterAndRender() {
                const dataSet = currentTab === 'top10' ? qaData.top10 : qaData.allQueries;

                const filtered = dataSet.filter(item => {
                    const matchesCategory = currentCategory === 'all' || item.category === currentCategory;
                    const searchStr = currentSearchTerm.toLowerCase();
                    const matchesSearch = !searchStr ||
                        item.query.toLowerCase().includes(searchStr) ||
                        item.reply.toLowerCase().includes(searchStr) ||
                        item.category.toLowerCase().includes(searchStr);
                    return matchesCategory && matchesSearch;
                });

                faqList.innerHTML = filtered.map((item, index) => renderItem(item, index)).join('');

                countValue.textContent = filtered.length;
                if (filtered.length === 0) {
                    noResults.classList.remove('hidden');
                    resultsCount.classList.add('hidden');
                } else {
                    noResults.classList.add('hidden');
                    resultsCount.classList.remove('hidden');
                }
            }

            // --- Event Listeners ---

            // Tabs
            tabTop10.addEventListener('click', () => {
                currentTab = 'top10';
                tabTop10.classList.add('tab-active');
                tabTop10.classList.remove('tab-inactive');
                tabArchive.classList.add('tab-inactive');
                tabArchive.classList.remove('tab-active');
                sectionTitle.textContent = "Top 10 Frequently Asked Questions";
                filterAndRender();
            });

            tabArchive.addEventListener('click', () => {
                currentTab = 'archive';
                tabArchive.classList.add('tab-active');
                tabArchive.classList.remove('tab-inactive');
                tabTop10.classList.add('tab-inactive');
                tabTop10.classList.remove('tab-active');
                sectionTitle.textContent = "Past Q&A Archive";
                filterAndRender();
            });

            // Search
            searchInput.addEventListener('input', (e) => {
                currentSearchTerm = e.target.value.trim();
                filterAndRender();
            });

            // Categories
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // UI Update
                    categoryBtns.forEach(b => {
                        b.classList.remove('active-category');
                        b.classList.add('inactive-category');
                    });
                    btn.classList.add('active-category');
                    btn.classList.remove('inactive-category');

                    // State Update
                    currentCategory = btn.getAttribute('data-category');
                    filterAndRender();
                });
            });

            // Clear Search
            clearSearchBtn.addEventListener('click', () => {
                searchInput.value = '';
                currentSearchTerm = '';
                currentCategory = 'all';
                // Reset category UI
                categoryBtns.forEach(b => {
                    b.classList.remove('active-category');
                    b.classList.add('inactive-category');
                    if (b.dataset.category === 'all') b.classList.add('active-category');
                });
                filterAndRender();
            });

            // Check for URL param
            const urlParams = new URLSearchParams(window.location.search);
            const queryParam = urlParams.get('search');
            if (queryParam) {
                searchInput.value = queryParam;
                currentSearchTerm = queryParam;
                // Auto switch to archive if search is deep? Default top 10 is fine.
                // If user searches, they probably want to search everything. 
                // Let's autoswitch to 'archive' if it's a specific search not in top 10? 
                // Simpler: Just search current tab. BUT maybe better to search Archive by default if coming from external search?
                // Let's stick to default behavior (Top 10) unless user clicks "All". 
                // Actually, if query param exists, switching to 'archive' might be safer to find results.
                currentTab = 'archive';
                tabArchive.click(); // Trigger UI switch
            } else {
                // Initial Render
                filterAndRender();
            }
        });
    </script>
</body>

</html>